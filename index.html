<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUKO Capital - Sistema de Conciliaci√≥n</title>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0A2540;
            --primary-light: #1A3A5F;
            --accent: #00D4AA;
            --accent-dark: #00B894;
            --background: #F7F9FC;
            --surface: #FFFFFF;
            --text: #1E293B;
            --text-light: #64748B;
            --border: #E2E8F0;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --info: #3B82F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Archivo', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--primary);
            color: white;
            padding: 2rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .logo {
            padding: 0 2rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .logo p {
            font-size: 0.875rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-title {
            padding: 0 2rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0.6;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .nav-item {
            padding: 0.875rem 2rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            position: relative;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-left-color: var(--accent);
        }

        .nav-item.active {
            background: rgba(0, 212, 170, 0.1);
            border-left-color: var(--accent);
            font-weight: 600;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            opacity: 0.8;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem;
        }

        .header {
            background: var(--surface);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .header h2 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-light);
            font-size: 1rem;
        }

        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--surface);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transform: translateY(-2px);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 0.875rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--error);
        }

        /* Conciliaci√≥n Panel */
        .conciliacion-panel {
            background: var(--surface);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .panel-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--primary);
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
        }

        .btn-secondary {
            background: var(--background);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: var(--accent);
            background: rgba(0, 212, 170, 0.02);
        }

        .upload-area.dragover {
            border-color: var(--accent);
            background: rgba(0, 212, 170, 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .upload-text {
            font-size: 1.125rem;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        /* Table */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1.5rem;
        }

        .data-table thead {
            background: var(--background);
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text);
            font-size: 0.875rem;
            border-bottom: 2px solid var(--border);
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            font-size: 0.875rem;
        }

        .data-table tbody tr {
            transition: background 0.2s ease;
        }

        .data-table tbody tr:hover {
            background: var(--background);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            gap: 0.375rem;
        }

        .status-badge.conciliado {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-badge.pendiente {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-badge.diferencia {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        /* Progress Bar */
        .progress-container {
            margin: 2rem 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent) 0%, var(--accent-dark) 100%);
            transition: width 0.3s ease;
            border-radius: 999px;
        }

        /* Comparison View */
        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .comparison-column {
            background: var(--background);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .comparison-header {
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .comparison-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .difference-indicator {
            text-align: center;
            padding: 1rem;
            background: var(--surface);
            border-radius: 12px;
            margin: 1rem 0;
            border: 2px solid var(--border);
        }

        .difference-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }

        .difference-value.zero {
            color: var(--success);
        }

        .difference-value.nonzero {
            color: var(--error);
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: slideIn 0.4s ease;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .processing {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* File List */
        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--background);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .file-details h4 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .file-details p {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .file-actions {
            display: flex;
            gap: 0.5rem;
        }

        .icon-btn {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            background: var(--surface);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .icon-btn:hover {
            background: var(--border);
            transform: scale(1.05);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .main-content {
                margin-left: 0;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .comparison-container {
                grid-template-columns: 1fr;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--background);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            background-color: var(--primary);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem 1rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem;
            white-space: nowrap;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <h1>NUKO Capital</h1>
                <p>Sistema de Conciliaci√≥n</p>
            </div>
            
            <nav>
                <div class="nav-section">
                    <div class="nav-title">Principal</div>
                    <div class="nav-item active" onclick="showSection('dashboard')">
                        <span class="nav-icon">üìä</span>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" onclick="showSection('nueva')">
                        <span class="nav-icon">‚ûï</span>
                        <span>Nueva Conciliaci√≥n</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Cuentas Bancarias</div>
                    <div class="nav-item" onclick="showSection('bancos-estandar')">
                        <span class="nav-icon">üè¶</span>
                        <span>Bancos Est√°ndar</span>
                    </div>
                    <div class="nav-item" onclick="showSection('bancos-especial')">
                        <span class="nav-icon">üí≥</span>
                        <span>Comdata & Wex</span>
                    </div>
                    <div class="nav-item" onclick="showSection('loadconnex')">
                        <span class="nav-icon">‚õΩ</span>
                        <span>LoadConnex</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Cuentas por Cobrar</div>
                    <div class="nav-item" onclick="showSection('factored')">
                        <span class="nav-icon">üìà</span>
                        <span>Factored Receivables</span>
                    </div>
                    <div class="nav-item" onclick="showSection('cash-reserve')">
                        <span class="nav-icon">üí∞</span>
                        <span>Cash Reserve</span>
                    </div>
                    <div class="nav-item" onclick="showSection('client-note')">
                        <span class="nav-icon">üìù</span>
                        <span>Client Note Receivable</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Cuentas por Pagar</div>
                    <div class="nav-item" onclick="showSection('client-payable')">
                        <span class="nav-icon">üíº</span>
                        <span>Client Payable</span>
                    </div>
                    <div class="nav-item" onclick="showSection('unapplied')">
                        <span class="nav-icon">üîÑ</span>
                        <span>Unapplied Cash</span>
                    </div>
                    <div class="nav-item" onclick="showSection('escrow')">
                        <span class="nav-icon">üîí</span>
                        <span>Escrow Reserve</span>
                    </div>
                    <div class="nav-item" onclick="showSection('nfusion')">
                        <span class="nav-icon">üîó</span>
                        <span>A/P NFusion</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Otros</div>
                    <div class="nav-item" onclick="showSection('fees')">
                        <span class="nav-icon">üíµ</span>
                        <span>Ingresos (Fees)</span>
                    </div>
                    <div class="nav-item" onclick="showSection('corporativas')">
                        <span class="nav-icon">üè¢</span>
                        <span>Cuentas Corporativas</span>
                    </div>
                    <div class="nav-item" onclick="showSection('inversores')">
                        <span class="nav-icon">üìä</span>
                        <span>Inversores</span>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="animate-in">
                <div class="header">
                    <h2>Dashboard de Conciliaci√≥n</h2>
                    <p>Resumen ejecutivo del mes actual</p>
                </div>

                <div class="cards-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Cuentas Conciliadas</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success);">‚úì</div>
                        </div>
                        <div class="stat-value">24/32</div>
                        <div class="stat-change positive">
                            <span>‚Üë 75%</span>
                            <span>completado</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Diferencias Detectadas</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: var(--warning);">‚ö†</div>
                        </div>
                        <div class="stat-value">8</div>
                        <div class="stat-change">
                            <span>pendientes de revisi√≥n</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Monto Total Conciliado</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(0, 212, 170, 0.1); color: var(--accent);">$</div>
                        </div>
                        <div class="stat-value">$2.4M</div>
                        <div class="stat-change positive">
                            <span>‚Üë 12%</span>
                            <span>vs mes anterior</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-title">Tiempo Promedio</div>
                            </div>
                            <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: var(--info);">‚è±</div>
                        </div>
                        <div class="stat-value">2.5h</div>
                        <div class="stat-change positive">
                            <span>‚Üì 40%</span>
                            <span>optimizaci√≥n</span>
                        </div>
                    </div>
                </div>

                <div class="conciliacion-panel">
                    <div class="panel-header">
                        <h3 class="panel-title">Estado de Conciliaciones</h3>
                        <div class="action-buttons">
                            <button class="btn btn-secondary">
                                <span>üì•</span>
                                <span>Exportar</span>
                            </button>
                            <button class="btn btn-primary" onclick="showSection('nueva')">
                                <span>‚ûï</span>
                                <span>Nueva Conciliaci√≥n</span>
                            </button>
                        </div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Cuenta</th>
                                <th>Tipo</th>
                                <th>Balance QB</th>
                                <th>Balance Sistema</th>
                                <th>Diferencia</th>
                                <th>Estado</th>
                                <th>√öltima Actualizaci√≥n</th>
                            </tr>
                        </thead>
                        <tbody id="conciliacionesTable">
                            <tr>
                                <td>BOA 1695</td>
                                <td>Banco Est√°ndar</td>
                                <td>$145,230.00</td>
                                <td>$145,230.00</td>
                                <td>$0.00</td>
                                <td><span class="status-badge conciliado"><span class="status-dot"></span>Conciliado</span></td>
                                <td>30/01/2026</td>
                            </tr>
                            <tr>
                                <td>TCB 9513</td>
                                <td>Banco Est√°ndar</td>
                                <td>$89,450.50</td>
                                <td>$89,450.50</td>
                                <td>$0.00</td>
                                <td><span class="status-badge conciliado"><span class="status-dot"></span>Conciliado</span></td>
                                <td>30/01/2026</td>
                            </tr>
                            <tr>
                                <td>Comdata</td>
                                <td>Banco Especial</td>
                                <td>$52,100.00</td>
                                <td>$51,950.00</td>
                                <td>$150.00</td>
                                <td><span class="status-badge diferencia"><span class="status-dot"></span>Diferencia</span></td>
                                <td>30/01/2026</td>
                            </tr>
                            <tr>
                                <td>LoadConnex</td>
                                <td>Combustible</td>
                                <td>$34,890.25</td>
                                <td>$34,890.25</td>
                                <td>$0.00</td>
                                <td><span class="status-badge conciliado"><span class="status-dot"></span>Conciliado</span></td>
                                <td>30/01/2026</td>
                            </tr>
                            <tr>
                                <td>Factored Receivables</td>
                                <td>Cuentas por Cobrar</td>
                                <td>$892,450.00</td>
                                <td>$890,200.00</td>
                                <td>$2,250.00</td>
                                <td><span class="status-badge pendiente"><span class="status-dot"></span>Pendiente</span></td>
                                <td>29/01/2026</td>
                            </tr>
                            <tr>
                                <td>Cash Reserve</td>
                                <td>Cuentas por Cobrar</td>
                                <td>$156,780.00</td>
                                <td>$156,780.00</td>
                                <td>$0.00</td>
                                <td><span class="status-badge conciliado"><span class="status-dot"></span>Conciliado</span></td>
                                <td>30/01/2026</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Nueva Conciliaci√≥n Section -->
            <section id="nueva-section" style="display: none;">
                <div class="header">
                    <h2>Nueva Conciliaci√≥n</h2>
                    <p>Selecciona el tipo de cuenta y carga los archivos necesarios</p>
                </div>

                <div class="conciliacion-panel">
                    <div class="panel-header">
                        <h3 class="panel-title">Configuraci√≥n de Conciliaci√≥n</h3>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Selecciona el tipo de cuenta</label>
                        <select id="tipoCuenta" onchange="updateUploadInstructions()" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; font-size: 1rem; background: var(--surface);">
                            <option value="">-- Selecciona una opci√≥n --</option>
                            <optgroup label="Cuentas Bancarias">
                                <option value="banco-estandar">Banco Est√°ndar (BOA, TCB, TAB)</option>
                                <option value="banco-especial">Banco Especial (Comdata, Wex)</option>
                                <option value="loadconnex">LoadConnex</option>
                            </optgroup>
                            <optgroup label="Cuentas por Cobrar">
                                <option value="factored">Factored Receivables</option>
                                <option value="cash-reserve">Cash Reserve</option>
                                <option value="client-note">Client Note Receivable</option>
                            </optgroup>
                            <optgroup label="Cuentas por Pagar">
                                <option value="client-payable">Client Payable</option>
                                <option value="unapplied">Unapplied Cash</option>
                                <option value="escrow">Escrow Reserve</option>
                                <option value="nfusion">A/P NFusion</option>
                            </optgroup>
                            <optgroup label="Otros">
                                <option value="fees">Ingresos (Fees)</option>
                                <option value="corporativas">Cuentas Corporativas</option>
                                <option value="inversores">Inversores</option>
                            </optgroup>
                        </select>
                    </div>

                    <div id="uploadInstructions" style="background: var(--background); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; display: none;">
                        <h4 style="font-weight: 600; margin-bottom: 1rem; color: var(--primary);">üìã Archivos Requeridos:</h4>
                        <div id="instructionsContent"></div>
                    </div>

                    <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">Arrastra archivos aqu√≠ o haz clic para seleccionar</div>
                        <div class="upload-hint">Soporta: Excel (.xlsx), CSV, PDF</div>
                        <input type="file" id="fileInput" multiple accept=".xlsx,.xls,.csv,.pdf" style="display: none;" onchange="handleFileSelect(event)">
                    </div>

                    <div id="fileList" class="file-list" style="display: none;"></div>

                    <div id="processingArea" style="display: none;">
                        <div class="progress-container">
                            <div class="progress-info">
                                <span id="progressLabel">Procesando archivos...</span>
                                <span id="progressPercent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <div id="resultsArea" style="display: none;">
                        <div class="comparison-container">
                            <div class="comparison-column">
                                <div class="comparison-header">
                                    <span>QuickBooks</span>
                                    <span style="font-size: 0.875rem; color: var(--text-light);">Balance Final</span>
                                </div>
                                <div class="comparison-value" id="qbValue">$0.00</div>
                            </div>

                            <div class="comparison-column">
                                <div class="comparison-header">
                                    <span id="systemLabel">Sistema</span>
                                    <span style="font-size: 0.875rem; color: var(--text-light);">Balance Final</span>
                                </div>
                                <div class="comparison-value" id="systemValue">$0.00</div>
                            </div>
                        </div>

                        <div class="difference-indicator">
                            <div style="font-size: 0.875rem; color: var(--text-light); margin-bottom: 0.5rem;">Diferencia</div>
                            <div class="difference-value zero" id="differenceValue">$0.00</div>
                            <div id="differenceMessage" style="margin-top: 0.5rem; font-size: 0.875rem;"></div>
                        </div>

                        <div class="action-buttons" style="justify-content: center; margin-top: 2rem;">
                            <button class="btn btn-secondary" onclick="resetConciliacion()">
                                <span>üîÑ</span>
                                <span>Nueva Conciliaci√≥n</span>
                            </button>
                            <button class="btn btn-primary" onclick="exportResults()">
                                <span>üì•</span>
                                <span>Exportar Reporte</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Navigation
        function showSection(section) {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');

            // Show corresponding section
            document.querySelectorAll('section').forEach(sec => {
                sec.style.display = 'none';
            });

            if (section === 'dashboard') {
                document.getElementById('dashboard-section').style.display = 'block';
            } else if (section === 'nueva') {
                document.getElementById('nueva-section').style.display = 'block';
            } else {
                // For other sections, show the nueva-section with pre-selected type
                document.getElementById('nueva-section').style.display = 'block';
                const typeMap = {
                    'bancos-estandar': 'banco-estandar',
                    'bancos-especial': 'banco-especial',
                    'loadconnex': 'loadconnex',
                    'factored': 'factored',
                    'cash-reserve': 'cash-reserve',
                    'client-note': 'client-note',
                    'client-payable': 'client-payable',
                    'unapplied': 'unapplied',
                    'escrow': 'escrow',
                    'nfusion': 'nfusion',
                    'fees': 'fees',
                    'corporativas': 'corporativas',
                    'inversores': 'inversores'
                };
                const tipoCuenta = document.getElementById('tipoCuenta');
                tipoCuenta.value = typeMap[section] || '';
                updateUploadInstructions();
            }
        }

        // Upload instructions
        function updateUploadInstructions() {
            const tipo = document.getElementById('tipoCuenta').value;
            const instructionsDiv = document.getElementById('uploadInstructions');
            const contentDiv = document.getElementById('instructionsContent');

            if (!tipo) {
                instructionsDiv.style.display = 'none';
                return;
            }

            instructionsDiv.style.display = 'block';

            const instructions = {
                'banco-estandar': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Balance Sheet ‚Üí [Nombre del banco])</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Finance Report del √°rea de ingresos (que coincide con el statement del banco)</span>
                        </li>
                    </ul>
                `,
                'banco-especial': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Balance Sheet ‚Üí Comdata/Wex)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Movimientos bancarios (Drive ‚Üí Reportes Financieros ‚Üí Reportes bancarios)</span>
                        </li>
                    </ul>
                `,
                'loadconnex': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Balance Sheet ‚Üí LoadConnex)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Reporte de LoadConnex (Fuel Statements ‚Üí Accounting CSV del mes)</span>
                        </li>
                    </ul>
                `,
                'factored': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Accounts receivables aging summary)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Reporte de FactorView (Reports ‚Üí Management ‚Üí Aging)</span>
                        </li>
                    </ul>
                `,
                'cash-reserve': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Balance Sheet ‚Üí Cash reserve filtrado por Vendor)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Reporte de FactorView (Reports ‚Üí Client ‚Üí Reserve Report)</span>
                        </li>
                    </ul>
                `,
                'client-note': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de QuickBooks (Reports ‚Üí Balance Sheet ‚Üí Client Note Receivable)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Reporte de FactorView (Tools ‚Üí Client loans)</span>
                        </li>
                    </ul>
                `,
                'fees': `
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">1.</span>
                            <span>Reporte de ingresos de QuickBooks por tipo (ACH fee, Wire fee, Discount fee, etc.)</span>
                        </li>
                        <li style="margin-bottom: 0.75rem; display: flex; align-items: start; gap: 0.5rem;">
                            <span style="color: var(--accent); font-weight: bold;">2.</span>
                            <span>Reporte de FactorView con el desglose de fees del mes</span>
                        </li>
                    </ul>
                `
            };

            contentDiv.innerHTML = instructions[tipo] || '<p>Selecciona el tipo de cuenta para ver los archivos requeridos.</p>';
        }

        // File upload handling
        const uploadArea = document.getElementById('uploadArea');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => {
                uploadArea.classList.add('dragover');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => {
                uploadArea.classList.remove('dragover');
            }, false);
        });

        uploadArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            const fileList = document.getElementById('fileList');
            fileList.style.display = 'block';
            fileList.innerHTML = '';

            Array.from(files).forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item animate-in';
                fileItem.style.animationDelay = `${index * 0.1}s`;
                
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon">${getFileIcon(file.name)}</div>
                        <div class="file-details">
                            <h4>${file.name}</h4>
                            <p>${formatFileSize(file.size)} ‚Ä¢ ${file.type || 'Archivo'}</p>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="icon-btn" onclick="removeFile(this)" title="Eliminar">
                            üóëÔ∏è
                        </button>
                    </div>
                `;
                
                fileList.appendChild(fileItem);
            });

            // Auto-start processing
            setTimeout(() => {
                processConciliacion();
            }, 500);
        }

        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'xlsx': 'üìä',
                'xls': 'üìä',
                'csv': 'üìã',
                'pdf': 'üìÑ'
            };
            return icons[ext] || 'üìÅ';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        function removeFile(button) {
            button.closest('.file-item').remove();
            const fileList = document.getElementById('fileList');
            if (fileList.children.length === 0) {
                fileList.style.display = 'none';
            }
        }

        // Process conciliacion
        function processConciliacion() {
            const processingArea = document.getElementById('processingArea');
            const resultsArea = document.getElementById('resultsArea');
            const progressFill = document.getElementById('progressFill');
            const progressPercent = document.getElementById('progressPercent');
            const progressLabel = document.getElementById('progressLabel');

            processingArea.style.display = 'block';
            resultsArea.style.display = 'none';

            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;

                progressFill.style.width = progress + '%';
                progressPercent.textContent = Math.round(progress) + '%';

                if (progress < 30) {
                    progressLabel.textContent = 'Leyendo archivos...';
                } else if (progress < 60) {
                    progressLabel.textContent = 'Comparando datos...';
                } else if (progress < 90) {
                    progressLabel.textContent = 'Calculando diferencias...';
                } else if (progress < 100) {
                    progressLabel.textContent = 'Generando reporte...';
                }

                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        showResults();
                    }, 500);
                }
            }, 200);
        }

        function showResults() {
            const processingArea = document.getElementById('processingArea');
            const resultsArea = document.getElementById('resultsArea');
            const tipo = document.getElementById('tipoCuenta').value;

            // Simulate results
            const qbValue = 145230.00;
            const systemValue = 145230.00 + (Math.random() > 0.5 ? Math.random() * 1000 - 500 : 0);
            const difference = qbValue - systemValue;

            document.getElementById('qbValue').textContent = '$' + qbValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('systemValue').textContent = '$' + systemValue.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('differenceValue').textContent = '$' + Math.abs(difference).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});

            const differenceValueEl = document.getElementById('differenceValue');
            const differenceMessage = document.getElementById('differenceMessage');

            if (Math.abs(difference) < 0.01) {
                differenceValueEl.className = 'difference-value zero';
                differenceMessage.innerHTML = '<span style="color: var(--success); font-weight: 600;">‚úì Las cuentas est√°n conciliadas correctamente</span>';
            } else {
                differenceValueEl.className = 'difference-value nonzero';
                differenceMessage.innerHTML = '<span style="color: var(--warning); font-weight: 600;">‚ö† Se detect√≥ una diferencia. Revisar partidas conciliatorias.</span>';
            }

            // Update system label based on type
            const systemLabels = {
                'banco-estandar': 'Finance Report',
                'banco-especial': 'Movimientos Bancarios',
                'loadconnex': 'LoadConnex',
                'factored': 'FactorView',
                'cash-reserve': 'FactorView',
                'client-note': 'FactorView'
            };
            document.getElementById('systemLabel').textContent = systemLabels[tipo] || 'Sistema';

            processingArea.style.display = 'none';
            resultsArea.style.display = 'block';
            resultsArea.classList.add('animate-in');
        }

        function resetConciliacion() {
            document.getElementById('fileList').innerHTML = '';
            document.getElementById('fileList').style.display = 'none';
            document.getElementById('fileInput').value = '';
            document.getElementById('processingArea').style.display = 'none';
            document.getElementById('resultsArea').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressPercent').textContent = '0%';
        }

        function exportResults() {
            alert('Exportando reporte de conciliaci√≥n... Esta funci√≥n generar√≠a un archivo Excel con los resultados completos.');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('NUKO Capital - Sistema de Conciliaci√≥n Cargado');
        });
    </script>
</body>
</html>
